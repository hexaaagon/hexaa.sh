{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "smooth-cursor",
  "type": "registry:component",
  "files": [
    {
      "path": "labs-registry/components-v1/smooth-cursor.tsx",
      "content": "\"use client\";\n\nimport { motion, useReducedMotion, useSpring } from \"motion/react\";\nimport { type JSX, useEffect, useRef, useState } from \"react\";\nimport { useIsMobile } from \"@/hooks/use-mobile\";\n\ninterface Position {\n  x: number;\n  y: number;\n}\n\nexport interface SmoothCursorProps {\n  cursor?: ({\n    cursorType,\n    isOverPointer,\n  }: {\n    cursorType: \"default\" | \"text\" | \"pointer\";\n    isOverPointer: boolean;\n  }) => JSX.Element;\n  disableRotation?: boolean;\n  disableSmooth?: boolean;\n  cursorType?: \"default\" | \"text\" | \"pointer\";\n}\n\nexport function SmoothCursor({\n  cursor: Cursor,\n  disableRotation = false,\n  disableSmooth = false,\n  cursorType = \"default\",\n}: SmoothCursorProps) {\n  const isMobile = useIsMobile();\n  const prefersReducedMotion = useReducedMotion();\n\n  const [hasMoved, setHasMoved] = useState(false);\n  const [isMoving, setIsMoving] = useState(false);\n  const [isOverPointer, setIsOverPointer] = useState(false);\n  const lastMousePos = useRef<Position>({ x: 0, y: 0 });\n  const velocity = useRef<Position>({ x: 0, y: 0 });\n  const lastUpdateTime = useRef(Date.now());\n  const previousAngle = useRef(-45);\n  const accumulatedRotation = useRef(-45);\n  const movingTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n\n  // Much more responsive cursor tracking - minimal lag\n  const cursorX = useSpring(0, {\n    stiffness: disableSmooth ? 10000 : 1200,\n    damping: disableSmooth ? 100 : 80,\n    mass: disableSmooth ? 0.1 : 0.3,\n  });\n  const cursorY = useSpring(0, {\n    stiffness: disableSmooth ? 10000 : 1200,\n    damping: disableSmooth ? 100 : 80,\n    mass: disableSmooth ? 0.1 : 0.3,\n  });\n  const rotation = useSpring(-45, {\n    stiffness: 800,\n    damping: 60,\n    mass: 0.4,\n  });\n  const scale = useSpring(1, {\n    stiffness: 1000,\n    damping: 70,\n    mass: 0.3,\n  });\n\n  useEffect(() => {\n    if (isMobile) return;\n\n    const updateVelocity = (currentPos: Position) => {\n      const currentTime = Date.now();\n      const deltaTime = currentTime - lastUpdateTime.current;\n\n      if (deltaTime > 0) {\n        velocity.current = {\n          x: (currentPos.x - lastMousePos.current.x) / deltaTime,\n          y: (currentPos.y - lastMousePos.current.y) / deltaTime,\n        };\n      }\n\n      lastUpdateTime.current = currentTime;\n      lastMousePos.current = currentPos;\n    };\n\n    const checkIfOverElement = (e: MouseEvent) => {\n      const element = document.elementFromPoint(e.clientX, e.clientY);\n      if (element) {\n        const isPointerElement =\n          element.closest(\"a, button\") !== null ||\n          window.getComputedStyle(element).cursor === \"pointer\";\n        setIsOverPointer(isPointerElement);\n      }\n    };\n\n    const smoothMouseMove = (e: MouseEvent) => {\n      const currentPos = { x: e.clientX, y: e.clientY };\n      updateVelocity(currentPos);\n      checkIfOverElement(e);\n\n      const speed = Math.sqrt(\n        velocity.current.x ** 2 + velocity.current.y ** 2,\n      );\n\n      cursorX.set(currentPos.x);\n      cursorY.set(currentPos.y);\n\n      if (speed > 0.1) {\n        if (!disableRotation && !prefersReducedMotion) {\n          const currentAngle =\n            Math.atan2(velocity.current.y, velocity.current.x) *\n              (180 / Math.PI) +\n            90;\n\n          let angleDiff = currentAngle - previousAngle.current;\n          if (angleDiff > 180) angleDiff -= 360;\n          if (angleDiff < -180) angleDiff += 360;\n          accumulatedRotation.current += angleDiff;\n          rotation.set(accumulatedRotation.current);\n          previousAngle.current = currentAngle;\n        }\n\n        // Faster scale feedback\n        scale.set(prefersReducedMotion ? 1 : 0.99);\n        setHasMoved(true);\n        setIsMoving(true);\n\n        // Clear previous timeout if it exists\n        if (movingTimeoutRef.current) {\n          clearTimeout(movingTimeoutRef.current);\n        }\n\n        // Set new timeout to mark as not moving\n        movingTimeoutRef.current = setTimeout(\n          () => {\n            scale.set(1);\n            setIsMoving(false);\n            movingTimeoutRef.current = null;\n          },\n          prefersReducedMotion ? 0 : 500, // 1 second timeout when cursor stops\n        );\n      }\n    };\n\n    let rafId: number;\n    const throttledMouseMove = (e: MouseEvent) => {\n      if (rafId) return;\n\n      rafId = requestAnimationFrame(() => {\n        smoothMouseMove(e);\n        rafId = 0;\n      });\n    };\n\n    window.addEventListener(\"mousemove\", throttledMouseMove);\n\n    return () => {\n      window.removeEventListener(\"mousemove\", throttledMouseMove);\n      if (rafId) cancelAnimationFrame(rafId);\n      // Clean up moving timeout on unmount\n      if (movingTimeoutRef.current) {\n        clearTimeout(movingTimeoutRef.current);\n      }\n    };\n  }, [\n    cursorX,\n    cursorY,\n    rotation,\n    scale,\n    disableRotation,\n    isMobile,\n    prefersReducedMotion,\n  ]);\n\n  if (isMobile || !hasMoved) {\n    return null;\n  }\n\n  return (\n    <motion.div\n      className={`pointer-events-none fixed z-99999 translate-x-[-50%] translate-y-[-50%] mix-blend-exclusion transition-[scale,opacity] ${isMoving || cursorType === \"pointer\" || isOverPointer ? \"scale-100 opacity-100 duration-300\" : \"scale-200 opacity-0 duration-700\"}`}\n      style={{\n        left: cursorX,\n        top: cursorY,\n        transform: \"translateZ(0)\",\n        backfaceVisibility: \"hidden\",\n        willChange: \"transform\",\n      }}\n    >\n      {Cursor ? (\n        <Cursor cursorType={cursorType} isOverPointer={isOverPointer} />\n      ) : (\n        <>\n          <div className=\"absolute h-[34px] w-[34px] dark:bg-white dark:blur-[7rem]\"></div>\n          <div\n            style={{\n              opacity: cursorType === \"pointer\" || isOverPointer ? 1 : 0,\n              scale: cursorType === \"pointer\" || isOverPointer ? 1.2 : 1,\n            }}\n            className={`pointer-events-none h-[34px] w-[34px] rounded-full border-2 bg-white shadow-sm transition-all duration-300 ease-out will-change-transform`}\n          ></div>\n          <div\n            style={{\n              opacity: !isOverPointer ? 1 : 0,\n            }}\n            className={`pointer-events-none absolute top-0 left-0 h-[34px] w-[34px] rounded-full border-2 shadow-sm drop-shadow-sm transition-all duration-300 ease-out will-change-transform dark:border-gray-700 ${disableRotation ? \"-rotate-45\" : \"\"}`}\n          ></div>\n        </>\n      )}\n    </motion.div>\n  );\n}\n",
      "type": "registry:component"
    }
  ]
}