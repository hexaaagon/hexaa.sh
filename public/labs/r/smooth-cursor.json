{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "smooth-cursor",
  "type": "registry:component",
  "description": "cursor go vroom vroom",
  "files": [
    {
      "path": "labs-registry/components-v1/smooth-cursor.tsx",
      "content": "\"use client\";\r\n\r\nimport { motion, useReducedMotion, useSpring } from \"motion/react\";\r\nimport { type JSX, useEffect, useRef, useState } from \"react\";\r\nimport { useIsMobile } from \"@/hooks/use-mobile\";\r\n\r\ninterface Position {\r\n  x: number;\r\n  y: number;\r\n}\r\n\r\nexport interface SmoothCursorProps {\r\n  cursor?: ({\r\n    cursorType,\r\n    isOverPointer,\r\n  }: {\r\n    cursorType: \"default\" | \"text\" | \"pointer\";\r\n    isOverPointer: boolean;\r\n  }) => JSX.Element;\r\n  disableRotation?: boolean;\r\n  disableSmooth?: boolean;\r\n  cursorType?: \"default\" | \"text\" | \"pointer\";\r\n}\r\n\r\nexport function SmoothCursor({\r\n  cursor: Cursor,\r\n  disableRotation = false,\r\n  disableSmooth = false,\r\n  cursorType = \"default\",\r\n}: SmoothCursorProps) {\r\n  const isMobile = useIsMobile();\r\n  const prefersReducedMotion = useReducedMotion();\r\n\r\n  const [hasMoved, setHasMoved] = useState(false);\r\n  const [isMoving, setIsMoving] = useState(false);\r\n  const [isOverPointer, setIsOverPointer] = useState(false);\r\n  const lastMousePos = useRef<Position>({ x: 0, y: 0 });\r\n  const velocity = useRef<Position>({ x: 0, y: 0 });\r\n  const lastUpdateTime = useRef(Date.now());\r\n  const previousAngle = useRef(-45);\r\n  const accumulatedRotation = useRef(-45);\r\n  const movingTimeoutRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n  // Much more responsive cursor tracking - minimal lag\r\n  const cursorX = useSpring(0, {\r\n    stiffness: disableSmooth ? 10000 : 1200,\r\n    damping: disableSmooth ? 100 : 80,\r\n    mass: disableSmooth ? 0.1 : 0.3,\r\n  });\r\n  const cursorY = useSpring(0, {\r\n    stiffness: disableSmooth ? 10000 : 1200,\r\n    damping: disableSmooth ? 100 : 80,\r\n    mass: disableSmooth ? 0.1 : 0.3,\r\n  });\r\n  const rotation = useSpring(-45, {\r\n    stiffness: 800,\r\n    damping: 60,\r\n    mass: 0.4,\r\n  });\r\n  const scale = useSpring(1, {\r\n    stiffness: 1000,\r\n    damping: 70,\r\n    mass: 0.3,\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (isMobile) return;\r\n\r\n    const updateVelocity = (currentPos: Position) => {\r\n      const currentTime = Date.now();\r\n      const deltaTime = currentTime - lastUpdateTime.current;\r\n\r\n      if (deltaTime > 0) {\r\n        velocity.current = {\r\n          x: (currentPos.x - lastMousePos.current.x) / deltaTime,\r\n          y: (currentPos.y - lastMousePos.current.y) / deltaTime,\r\n        };\r\n      }\r\n\r\n      lastUpdateTime.current = currentTime;\r\n      lastMousePos.current = currentPos;\r\n    };\r\n\r\n    const checkIfOverElement = (e: MouseEvent) => {\r\n      const element = document.elementFromPoint(e.clientX, e.clientY);\r\n      if (element) {\r\n        const isPointerElement =\r\n          element.closest(\"a, button\") !== null ||\r\n          window.getComputedStyle(element).cursor === \"pointer\";\r\n        setIsOverPointer(isPointerElement);\r\n      }\r\n    };\r\n\r\n    const smoothMouseMove = (e: MouseEvent) => {\r\n      const currentPos = { x: e.clientX, y: e.clientY };\r\n      updateVelocity(currentPos);\r\n      checkIfOverElement(e);\r\n\r\n      const speed = Math.sqrt(\r\n        velocity.current.x ** 2 + velocity.current.y ** 2,\r\n      );\r\n\r\n      cursorX.set(currentPos.x);\r\n      cursorY.set(currentPos.y);\r\n\r\n      if (speed > 0.1) {\r\n        if (!disableRotation && !prefersReducedMotion) {\r\n          const currentAngle =\r\n            Math.atan2(velocity.current.y, velocity.current.x) *\r\n              (180 / Math.PI) +\r\n            90;\r\n\r\n          let angleDiff = currentAngle - previousAngle.current;\r\n          if (angleDiff > 180) angleDiff -= 360;\r\n          if (angleDiff < -180) angleDiff += 360;\r\n          accumulatedRotation.current += angleDiff;\r\n          rotation.set(accumulatedRotation.current);\r\n          previousAngle.current = currentAngle;\r\n        }\r\n\r\n        // Faster scale feedback\r\n        scale.set(prefersReducedMotion ? 1 : 0.99);\r\n        setHasMoved(true);\r\n        setIsMoving(true);\r\n\r\n        // Clear previous timeout if it exists\r\n        if (movingTimeoutRef.current) {\r\n          clearTimeout(movingTimeoutRef.current);\r\n        }\r\n\r\n        // Set new timeout to mark as not moving\r\n        movingTimeoutRef.current = setTimeout(\r\n          () => {\r\n            scale.set(1);\r\n            setIsMoving(false);\r\n            movingTimeoutRef.current = null;\r\n          },\r\n          prefersReducedMotion ? 0 : 500, // 1 second timeout when cursor stops\r\n        );\r\n      }\r\n    };\r\n\r\n    let rafId: number;\r\n    const throttledMouseMove = (e: MouseEvent) => {\r\n      if (rafId) return;\r\n\r\n      rafId = requestAnimationFrame(() => {\r\n        smoothMouseMove(e);\r\n        rafId = 0;\r\n      });\r\n    };\r\n\r\n    window.addEventListener(\"mousemove\", throttledMouseMove);\r\n\r\n    return () => {\r\n      window.removeEventListener(\"mousemove\", throttledMouseMove);\r\n      if (rafId) cancelAnimationFrame(rafId);\r\n      // Clean up moving timeout on unmount\r\n      if (movingTimeoutRef.current) {\r\n        clearTimeout(movingTimeoutRef.current);\r\n      }\r\n    };\r\n  }, [\r\n    cursorX,\r\n    cursorY,\r\n    rotation,\r\n    scale,\r\n    disableRotation,\r\n    isMobile,\r\n    prefersReducedMotion,\r\n  ]);\r\n\r\n  if (isMobile || !hasMoved) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <motion.div\r\n      className={`pointer-events-none fixed z-99999 translate-x-[-50%] translate-y-[-50%] mix-blend-exclusion transition-[scale,opacity] ${isMoving || cursorType === \"pointer\" || isOverPointer ? \"scale-100 opacity-100 duration-300\" : \"scale-200 opacity-0 duration-700\"}`}\r\n      style={{\r\n        left: cursorX,\r\n        top: cursorY,\r\n        transform: \"translateZ(0)\",\r\n        backfaceVisibility: \"hidden\",\r\n        willChange: \"transform\",\r\n      }}\r\n    >\r\n      {Cursor ? (\r\n        <Cursor cursorType={cursorType} isOverPointer={isOverPointer} />\r\n      ) : (\r\n        <>\r\n          <div className=\"absolute h-[34px] w-[34px] dark:bg-white dark:blur-[7rem]\"></div>\r\n          <div\r\n            style={{\r\n              opacity: cursorType === \"pointer\" || isOverPointer ? 1 : 0,\r\n              scale: cursorType === \"pointer\" || isOverPointer ? 1.2 : 1,\r\n            }}\r\n            className={`pointer-events-none h-[34px] w-[34px] rounded-full border-2 bg-white shadow-sm transition-all duration-300 ease-out will-change-transform`}\r\n          ></div>\r\n          <div\r\n            style={{\r\n              opacity: !isOverPointer ? 1 : 0,\r\n            }}\r\n            className={`pointer-events-none absolute top-0 left-0 h-[34px] w-[34px] rounded-full border-2 shadow-sm drop-shadow-sm transition-all duration-300 ease-out will-change-transform dark:border-gray-700 ${disableRotation ? \"-rotate-45\" : \"\"}`}\r\n          ></div>\r\n        </>\r\n      )}\r\n    </motion.div>\r\n  );\r\n}\r\n",
      "type": "registry:component"
    }
  ]
}