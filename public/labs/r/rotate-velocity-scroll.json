{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "rotate-velocity-scroll",
  "type": "registry:component",
  "description": "element go spin and based on scroll velocity and more cooler",
  "files": [
    {
      "path": "labs-registry/components-v1/rotate-velocity-scroll.tsx",
      "content": "\"use client\";\n\nimport { useEffect, useRef } from \"react\";\nimport {\n  motion,\n  useAnimationFrame,\n  useMotionValue,\n  useScroll,\n  useSpring,\n  useTransform,\n  useVelocity,\n} from \"motion/react\";\n\nexport interface ScrollVelocityRotateProps {\n  children: React.ReactNode;\n  baseVelocity?: number;\n  className?: string;\n}\n\nexport function ScrollVelocityRotate({\n  children,\n  baseVelocity = 50,\n  className,\n}: ScrollVelocityRotateProps) {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const { scrollY } = useScroll();\n  const scrollVelocity = useVelocity(scrollY);\n  const smoothVelocity = useSpring(scrollVelocity, {\n    damping: 50,\n    stiffness: 400,\n  });\n\n  const velocityFactor = useTransform(smoothVelocity, (v) => {\n    const sign = v < 0 ? -1 : 1;\n    const magnitude = Math.min(5, (Math.abs(v) / 1000) * 5);\n    return sign * magnitude;\n  });\n\n  const rotation = useMotionValue(0);\n  const currentDirectionRef = useRef<number>(1);\n  const isInViewRef = useRef(true);\n  const isPageVisibleRef = useRef(true);\n  const prefersReducedMotionRef = useRef(false);\n\n  useEffect(() => {\n    const container = containerRef.current;\n    if (!container) return;\n\n    const io = new IntersectionObserver(([entry]) => {\n      isInViewRef.current = entry.isIntersecting;\n    });\n    io.observe(container);\n\n    const handleVisibility = () => {\n      isPageVisibleRef.current = document.visibilityState === \"visible\";\n    };\n    document.addEventListener(\"visibilitychange\", handleVisibility, {\n      passive: true,\n    });\n    handleVisibility();\n\n    const mq = window.matchMedia(\"(prefers-reduced-motion: reduce)\");\n    const handlePRM = () => {\n      prefersReducedMotionRef.current = mq.matches;\n    };\n    mq.addEventListener(\"change\", handlePRM);\n    handlePRM();\n\n    return () => {\n      io.disconnect();\n      document.removeEventListener(\"visibilitychange\", handleVisibility);\n      mq.removeEventListener(\"change\", handlePRM);\n    };\n  }, []);\n\n  useAnimationFrame((_, delta) => {\n    if (!isInViewRef.current || !isPageVisibleRef.current) return;\n\n    const dt = delta / 1000;\n    const vf = velocityFactor.get();\n    const absVf = Math.min(5, Math.abs(vf));\n    const speedMultiplier = prefersReducedMotionRef.current ? 0.5 : 1 + absVf;\n\n    // Update direction based on scroll velocity\n    if (absVf > 0.1) {\n      const scrollDirection = vf >= 0 ? 1 : -1;\n      currentDirectionRef.current = scrollDirection;\n    }\n\n    const degreesPerSecond = baseVelocity;\n    const rotateBy =\n      currentDirectionRef.current * degreesPerSecond * speedMultiplier * dt;\n\n    rotation.set(rotation.get() + rotateBy);\n  });\n\n  return (\n    <div ref={containerRef} className={className}>\n      <motion.div\n        style={{\n          rotate: rotation,\n        }}\n      >\n        {children}\n      </motion.div>\n    </div>\n  );\n}\n",
      "type": "registry:component"
    }
  ]
}