{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "rotate-velocity-scroll",
  "type": "registry:component",
  "description": "element go spin and based on scroll velocity and more cooler",
  "files": [
    {
      "path": "labs-registry/components-v1/rotate-velocity-scroll.tsx",
      "content": "\"use client\";\r\n\r\nimport { useEffect, useRef } from \"react\";\r\nimport {\r\n  motion,\r\n  useAnimationFrame,\r\n  useMotionValue,\r\n  useScroll,\r\n  useSpring,\r\n  useTransform,\r\n  useVelocity,\r\n} from \"motion/react\";\r\n\r\ninterface ScrollVelocityRotateProps {\r\n  children: React.ReactNode;\r\n  baseVelocity?: number;\r\n  className?: string;\r\n}\r\n\r\nexport function ScrollVelocityRotate({\r\n  children,\r\n  baseVelocity = 50,\r\n  className,\r\n}: ScrollVelocityRotateProps) {\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const { scrollY } = useScroll();\r\n  const scrollVelocity = useVelocity(scrollY);\r\n  const smoothVelocity = useSpring(scrollVelocity, {\r\n    damping: 50,\r\n    stiffness: 400,\r\n  });\r\n\r\n  const velocityFactor = useTransform(smoothVelocity, (v) => {\r\n    const sign = v < 0 ? -1 : 1;\r\n    const magnitude = Math.min(5, (Math.abs(v) / 1000) * 5);\r\n    return sign * magnitude;\r\n  });\r\n\r\n  const rotation = useMotionValue(0);\r\n  const currentDirectionRef = useRef<number>(1);\r\n  const isInViewRef = useRef(true);\r\n  const isPageVisibleRef = useRef(true);\r\n  const prefersReducedMotionRef = useRef(false);\r\n\r\n  useEffect(() => {\r\n    const container = containerRef.current;\r\n    if (!container) return;\r\n\r\n    const io = new IntersectionObserver(([entry]) => {\r\n      isInViewRef.current = entry.isIntersecting;\r\n    });\r\n    io.observe(container);\r\n\r\n    const handleVisibility = () => {\r\n      isPageVisibleRef.current = document.visibilityState === \"visible\";\r\n    };\r\n    document.addEventListener(\"visibilitychange\", handleVisibility, {\r\n      passive: true,\r\n    });\r\n    handleVisibility();\r\n\r\n    const mq = window.matchMedia(\"(prefers-reduced-motion: reduce)\");\r\n    const handlePRM = () => {\r\n      prefersReducedMotionRef.current = mq.matches;\r\n    };\r\n    mq.addEventListener(\"change\", handlePRM);\r\n    handlePRM();\r\n\r\n    return () => {\r\n      io.disconnect();\r\n      document.removeEventListener(\"visibilitychange\", handleVisibility);\r\n      mq.removeEventListener(\"change\", handlePRM);\r\n    };\r\n  }, []);\r\n\r\n  useAnimationFrame((_, delta) => {\r\n    if (!isInViewRef.current || !isPageVisibleRef.current) return;\r\n\r\n    const dt = delta / 1000;\r\n    const vf = velocityFactor.get();\r\n    const absVf = Math.min(5, Math.abs(vf));\r\n    const speedMultiplier = prefersReducedMotionRef.current ? 0.5 : 1 + absVf;\r\n\r\n    // Update direction based on scroll velocity\r\n    if (absVf > 0.1) {\r\n      const scrollDirection = vf >= 0 ? 1 : -1;\r\n      currentDirectionRef.current = scrollDirection;\r\n    }\r\n\r\n    const degreesPerSecond = baseVelocity;\r\n    const rotateBy =\r\n      currentDirectionRef.current * degreesPerSecond * speedMultiplier * dt;\r\n\r\n    rotation.set(rotation.get() + rotateBy);\r\n  });\r\n\r\n  return (\r\n    <div ref={containerRef} className={className}>\r\n      <motion.div\r\n        style={{\r\n          rotate: rotation,\r\n        }}\r\n      >\r\n        {children}\r\n      </motion.div>\r\n    </div>\r\n  );\r\n}\r\n",
      "type": "registry:component"
    }
  ]
}